<!DOCTYPE html>
<head>
  <title>Projects</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <h1>Projects</h1>

  <h2>Create Project</h2>
  <form id="create-project-form">
    <label for="title">Name:</label><br>
    <input type="text" id="title" name="title"><br>
    <label for="description">Description:</label><br>
    <textarea id="description" name="description"></textarea><br>
    <input type="submit" value="Create">
  </form>

  <% if (projects.length > 0) { %>
  <ul>
    <% projects.forEach(function(project) { %>
    <li>
      <h2><%= project.title %></h2>
      <p><%= project.description %></p>
      <button class="update-project-button" data-id="<%= project.id %>">Update</button>
      <button class="delete-project-button" data-id="<%= project.id %>">Delete</button>
    </li>
    <% }); %>
  </ul>
  <% } else { %>
  <p>No projects found.</p>
  <% } %>

  <script>
    $('#create-project-form').submit(function(e) {
      e.preventDefault();
      const title = $('#title').val();
      const content = $('#description').val();

      $.post('/projects', { title, content }, function(data) {
        // Refresh the page to see the new project
        location.reload();
      });
    });

    $('.update-project-button').click(function() {
      const id = $(this).data('id');
      const name = prompt('Enter new name');
      const description = prompt('Enter new description');
      $.ajax({
        url: '/projects/' + id,
        type: 'PUT',
        data: { name, description },
        success: function(data) {
          // Refresh the page to see the updated project
          location.reload();
        }
      });
    });

    $('.delete-project-button').click(function() {
      const id = $(this).data('id');
      $.ajax({
        url: '/projects/' + id,
        type: 'DELETE',
        success: function(data) {
          // Refresh the page to see the project removed
          location.reload();
        }
      });
    });
  </script>
</body>
</html>